import{A as I,r as c,b as _,x,d as E,c as l,u as e,a as t,l as N,f as h,g,w,R as D,t as n,k as y,v as L,F as R,y as V,o as u}from"./index-s91-ZGxd.js";import{store as C,updateTaskNote as F}from"./tasks-D-FyLJUj.js";import{f as i}from"./util-BrY1QKZh.js";import"./api-BHaqu5rT.js";const M={key:0},b={class:"italic title"},P={class:"stats"},U={key:0,class:"danger"},H={key:1,class:"italic"},j={key:0,class:"empty"},q={key:1},z={key:1},W={__name:"TaskDetailPage",setup(G){const k=x(),S=I(),A=parseInt(S.params.id),a=C.tasks.find(p=>p.id===A);let r=null;const d=c("");_(()=>{if(!a){k.push("/");return}d.value=a.notes||"",document.addEventListener("keydown",f)}),E(()=>{document.removeEventListener("keydown",f),r&&clearTimeout(r)});const f=p=>{p.key==="Escape"&&k.push("/")},v=c(!1),m=c(!1),B=()=>{v.value=!0,m.value=!1,r&&clearTimeout(r),r=setTimeout(async()=>{m.value=!0,await F(a.id,d.value),v.value=!1,m.value=!1},300)};return(p,s)=>e(a)?(u(),l("div",M,[t("p",null,[h(e(D),{to:"/"},{default:w(()=>[...s[1]||(s[1]=[g("Tasks",-1)])]),_:1}),g(" / "+n(e(a).title),1)]),t("h1",b,n(e(a).icon)+" "+n(e(a).title),1),t("div",P,[t("p",null," Avg. Estimated Time: "+n(e(i)(e(a).getAvgEstTime())),1),t("p",null," Avg. Actual Time: "+n(e(i)(e(a).getAvgRealTime())),1),t("p",null," Avg. Bias: "+n(e(i)(e(a).getAvgTimeBias()))+" ("+n(e(a).getAvgTimeBiasPercentage()?.toFixed(1))+"%) ",1),t("p",null,"Total Instances: "+n(e(a).taskInstances.length),1)]),s[4]||(s[4]=t("hr",null,null,-1)),t("h3",null,[s[2]||(s[2]=g(" Task notes ",-1)),v.value?(u(),l("span",U,"*")):y("",!0),m.value?(u(),l("span",H,"Saving changes...")):y("",!0)]),N(t("textarea",{onInput:B,"onUpdate:modelValue":s[0]||(s[0]=o=>d.value=o),name:"task-notes"},null,544),[[L,d.value]]),s[5]||(s[5]=t("hr",null,null,-1)),s[6]||(s[6]=t("h3",null,"Task Instances",-1)),e(a).taskInstances.length===0?(u(),l("div",j,[...s[3]||(s[3]=[t("p",null,"No instances yet. Start tracking!",-1)])])):(u(),l("ul",q,[(u(!0),l(R,null,V(e(a).taskInstances,(o,T)=>(u(),l("li",{key:T,class:"instance"},[t("strong",null,"Instance "+n(T+1),1),t("p",null," Started: "+n(new Date(o.timestampStarted).toLocaleString()),1),t("p",null," Estimated: "+n(e(i)(o.estDurationSec)),1),t("p",null," Actual: "+n(e(i)(o.realDurationSec)),1),t("p",null," Bias: "+n(e(i)(o.getTimeBias()))+" ("+n((o.getTimeBias()/o.estDurationSec*100).toFixed(1))+"%) ",1)]))),128))]))])):(u(),l("div",z,[...s[7]||(s[7]=[t("p",null,"Task not found",-1)])]))}};export{W as default};
