import{A as I,b as x,x as E,d as N,r as v,c as l,u as e,a as t,l as h,f as w,g as c,w as S,R as L,t as n,k as _,v as R,F as V,y as C,o as u}from"./index-BlHLjOWz.js";import{store as D,updateTaskNote as F}from"./tasks-B-rcv_cr.js";import{f as i}from"./util-BrY1QKZh.js";import"./api-D94axIJs.js";const M={key:0},b={class:"italic title"},P={class:"stats"},U={key:0,class:"danger"},H={key:1,class:"italic"},j={key:0,class:"empty"},q={key:1},z={key:1},W={__name:"TaskDetailPage",setup(G){const g=E(),y=I(),A=parseInt(y.params.id),a=D.tasks.find(m=>m.id===A);let r=null;x(()=>{a||g.push("/"),document.addEventListener("keydown",f)}),N(()=>{document.removeEventListener("keydown",f),r&&clearTimeout(r)});const f=m=>{m.key==="Escape"&&g.push("/")},p=v(!1),d=v(!1),k=v(a.task_note),B=()=>{p.value=!0,d.value=!1,r&&clearTimeout(r),r=setTimeout(async()=>{d.value=!0,await F(a.id,k.value),p.value=!1,d.value=!1},300)};return(m,s)=>e(a)?(u(),l("div",M,[t("p",null,[w(e(L),{to:"/"},{default:S(()=>[...s[1]||(s[1]=[c("Tasks",-1)])]),_:1}),c(" / "+n(e(a).title),1)]),t("h1",b,n(e(a).icon)+" "+n(e(a).title),1),t("div",P,[t("p",null," Avg. Estimated Time: "+n(e(i)(e(a).getAvgEstTime())),1),t("p",null," Avg. Actual Time: "+n(e(i)(e(a).getAvgRealTime())),1),t("p",null," Avg. Bias: "+n(e(i)(e(a).getAvgTimeBias()))+" ("+n(e(a).getAvgTimeBiasPercentage()?.toFixed(1))+"%) ",1),t("p",null,"Total Instances: "+n(e(a).taskInstances.length),1)]),s[4]||(s[4]=t("hr",null,null,-1)),t("h3",null,[s[2]||(s[2]=c(" Task notes ",-1)),p.value?(u(),l("span",U,"*")):_("",!0),d.value?(u(),l("span",H,"Saving changes...")):_("",!0)]),h(t("textarea",{onInput:B,"onUpdate:modelValue":s[0]||(s[0]=o=>k.value=o),name:"task-notes"},null,544),[[R,k.value]]),s[5]||(s[5]=t("hr",null,null,-1)),s[6]||(s[6]=t("h3",null,"Task Instances",-1)),e(a).taskInstances.length===0?(u(),l("div",j,[...s[3]||(s[3]=[t("p",null,"No instances yet. Start tracking!",-1)])])):(u(),l("ul",q,[(u(!0),l(V,null,C(e(a).taskInstances,(o,T)=>(u(),l("li",{key:T,class:"instance"},[t("strong",null,"Instance "+n(T+1),1),t("p",null," Started: "+n(new Date(o.timestamp_started).toLocaleString()),1),t("p",null," Estimated: "+n(e(i)(o.est_duration_sec)),1),t("p",null," Actual: "+n(e(i)(o.real_duration_sec)),1),t("p",null," Bias: "+n(e(i)(o.getTimeBias()))+" ("+n((o.getTimeBias()/o.est_duration_sec*100).toFixed(1))+"%) ",1)]))),128))]))])):(u(),l("div",z,[...s[7]||(s[7]=[t("p",null,"Task not found",-1)])]))}};export{W as default};
